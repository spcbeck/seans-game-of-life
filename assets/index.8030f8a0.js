var S=Object.defineProperty;var x=(s,e,t)=>e in s?S(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var r=(s,e,t)=>(x(s,typeof e!="symbol"?e+"":e,t),t);const w=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}};w();class B{constructor(e){r(this,"type");r(this,"alive");r(this,"neighborsCount",0);this.type=(e==null?void 0:e.type)||"Normal",this.alive=(e==null?void 0:e.alive)||!1}}const C={block:[[0,0],[0,1],[1,1],[1,0]],beehive:[[1,0],[2,0],[0,1],[3,1],[1,2],[2,2]],loaf:[],boat:[],tub:[],blinker:[[0,0],[1,0],[2,0]],toad:[[1,0],[2,0],[3,0],[0,1],[1,1],[2,1]],beacon:[[0,0],[0,1],[1,1],[1,0],[2,2],[3,2],[3,3],[2,3]],pulsar:[],"penta-decathlon":[],glider:[[1,0],[2,1],[0,2],[1,2],[2,2]],lwss:[],mwss:[],hwss:[]};class u{constructor(e){r(this,"board",[]);r(this,"tilesX",800);r(this,"tilesY",800);r(this,"width",800);r(this,"height",800);r(this,"ctx",null);r(this,"tileSize",10);r(this,"isGrowing",!0);r(this,"clearBoard",()=>{!this.ctx||this.ctx.clearRect(0,0,this.width,this.height)});r(this,"drawBoard",()=>{if(!!this.ctx)for(let e=0;e<this.tilesX;e++)for(let t=0;t<this.tilesY;t++)this.hasLiveCell(e,t,this.board)&&this.ctx.fillRect(e*this.tileSize,t*this.tileSize,this.tileSize,this.tileSize)});r(this,"drawBorders",()=>{if(!!this.ctx){for(let e=0;e<this.tilesX;e++)this.ctx.beginPath(),this.ctx.moveTo(e*this.tileSize-.5,0),this.ctx.lineTo(e*this.tileSize-.5,this.height),this.ctx.stroke();for(let e=0;e<this.tilesY;e++)this.ctx.beginPath(),this.ctx.moveTo(0,e*this.tileSize-.5),this.ctx.lineTo(this.width,e*this.tileSize-.5),this.ctx.stroke()}});r(this,"stepForward",()=>{let e=0;for(let t=0;t<this.tilesX;t++)for(let l=0;l<this.tilesY;l++){const i=this.liveNeighbors(t,l,this.board);this.board[t][l].neighborsCount=i}for(let t=0;t<this.tilesX;t++)for(let l=0;l<this.tilesY;l++){const i=this.board[t][l];!i.alive&&i.neighborsCount===3?(i.alive=!0,e++):(i.neighborsCount<2||i.neighborsCount>3)&&(i.alive=!1,e++)}e===0&&(this.isGrowing=!1)});r(this,"generateRandom",()=>{for(let e=0;e<this.tilesX;e++)for(let t=0;t<this.tilesY;t++)Math.random()<.1&&(this.board[e][t].alive=!0)});r(this,"hasLiveCell",(e,t,l)=>{var i;return e<0||e>=this.tilesX||t<0||t>=this.tilesY||l.length<=0?!1:((i=l[e][t])==null?void 0:i.alive)||!1});r(this,"liveNeighbors",(e,t,l)=>{let i=0;for(let o of[-1,0,1])for(let h of[-1,0,1])!(o===0&&h===0)&&this.hasLiveCell(e+o,t+h,l)&&i++;return i});r(this,"prepareBoard",()=>{for(let e=0;e<this.tilesX;e++){const t=[];for(let l=0;l<this.tilesY;l++)t.push(new B({alive:!1}));this.board.push(t)}return this.board});console.log(e),this.tilesX=e.tilesX,this.tilesY=e.tilesY,this.ctx=e.context,this.tileSize=e.tileSize,this.width=e.width,this.height=e.height,this.ctx.fillStyle=e.fillStyle,this.ctx.strokeStyle=e.strokeStyle,this.ctx.lineWidth=e.lineWidth}placeCellPattern(e,t,l,i){const o=C[l];for(const h of o){const b=e+h[0],p=t+h[1];i[b][p].alive=!0}return i}}let f=!1,c=100;const a=document.querySelector("#game"),g=s=>{let e=s.prepareBoard();return s.generateRandom(),s.placeCellPattern(10,10,"glider",e),s.placeCellPattern(20,10,"beehive",e),e},m=()=>{const s=parseInt(document.getElementById("canvasWidth").value),e=parseInt(document.getElementById("canvasHeight").value),t=parseInt(document.getElementById("cellSize").value),l=document.getElementById("cellColor").value;return{canvas:a,width:s,height:e,context:a==null?void 0:a.getContext("2d"),tileSize:t,tilesX:s/t,tilesY:e/t,fillStyle:l,strokeStyle:"rgb(90, 90, 90)",lineWidth:.5}};let d=m(),n=new u(d);g(n);const v=()=>{n.clearBoard(),n.drawBoard(),n.drawBorders()},y=()=>{f||(v(),n.stepForward())};y();const k=setInterval(()=>{y(),n.isGrowing||clearInterval(k)},c),z=()=>{d=m(),a.height=d.height,a.width=d.width,n=new u(d),g(n)};document.getElementById("reset").addEventListener("click",()=>{z()});document.addEventListener("keydown",s=>{s.key==="p"?f=!f:s.key==="+"?c=Math.max(50,c-50):s.key==="-"?c=Math.min(2e3,c+50):s.key==="r"&&(n.board=n.prepareBoard(),v())});
